# 運用・保守チェックリスト

## 📅 定期メンテナンススケジュール

### 🔄 日次チェック（毎日）
- [ ] **サイト表示確認** - https://www.otokuman.com 正常表示
- [ ] **EC2ステータス確認** - 16.176.167.244 応答確認
- [ ] **エラーログ確認**
  ```bash
  ssh -i "C:/Users/chun7/Downloads/otokuman.pem" ubuntu@16.176.167.244 'sudo tail -n 50 /var/log/apache2/error.log'
  ```
- [ ] **アクセス数確認** - 異常なアクセス・攻撃パターン検出
- [ ] **SSL証明書期限確認**（設定後）

### 📅 週次チェック（毎週月曜）
- [ ] **全ページ表示確認** 
  - トップページ：http://16.176.167.244
  - カテゴリページ：加湿器・空気清浄機・掃除機
  - 人気記事5記事
- [ ] **アフィリエイトリンク確認**
  - 楽天・Yahoo!ショッピングリンク有効性
  - 商品ページ存在確認
- [ ] **サイトマップ更新**
  ```bash
  # 新記事追加時
  nano sitemap.xml  # 新URL追加
  bash deploy.sh    # 反映
  ```
- [ ] **品質テスト実行**
  - ブラウザでF12開発者ツール
  - Console: `runSiteTest()`実行
  - エラー・警告の確認と対処

### 📊 月次チェック（毎月1日）
- [ ] **EC2スナップショット作成**
  - AWSコンソールでEBSスナップショット作成
  - 古いスナップショット削除（3ヶ月以上前）
- [ ] **価格情報更新確認**
  - 主要商品20商品の価格変動チェック
  - 大幅値上げ・値下げの記事反映
- [ ] **商品リンク一括確認**
  ```bash
  # リンク切れチェックツール実行
  # またはブラウザで主要商品ページ手動確認
  ```
- [ ] **Google Analytics・Search Console確認**
  - アクセス解析レビュー
  - 検索順位動向確認
  - クローラーエラー有無確認
- [ ] **セキュリティアップデート**
  ```bash
  ssh -i "C:/Users/chun7/Downloads/otokuman.pem" ubuntu@16.176.167.244 'sudo apt-get update && sudo apt-get upgrade -y'
  ```

### 🔄 季節更新（年4回）
- [ ] **春期（3月）** - 花粉・空気清浄機関連記事強化
- [ ] **夏期（6月）** - エアコン関連、除湿機能記事追加
- [ ] **秋期（9月）** - 加湿器・暖房準備記事強化  
- [ ] **冬期（12月）** - 大掃除・掃除機関連記事強化

### 📈 年次メンテナンス（毎年1月）
- [ ] **全記事年度更新**
  - 「2025年版」→「2026年版」
  - 新商品情報反映
  - 廃盤商品の差し替え
- [ ] **SEOキーワード戦略見直し**
- [ ] **サイト全体リニューアル検討**
- [ ] **収益分析・戦略見直し**

## 🚨 緊急時対応マニュアル

### サイトダウン時
1. **障害確認**
   ```bash
   curl -I http://16.176.167.244
   # レスポンスコード確認
   ```
2. **EC2ステータス確認** - AWSコンソール
3. **Apache再起動**
   ```bash
   ssh -i "C:/Users/chun7/Downloads/otokuman.pem" ubuntu@16.176.167.244 'sudo systemctl restart apache2'
   ```
4. **バックアップ復旧**（最終手段）
   ```bash
   ssh -i "C:/Users/chun7/Downloads/otokuman.pem" ubuntu@16.176.167.244 'sudo cp -r /var/www/html_backup/* /var/www/html/'
   ```

### 大量アクセス・DDoS対策
1. **アクセスログ確認**
   ```bash
   ssh -i "C:/Users/chun7/Downloads/otokuman.pem" ubuntu@16.176.167.244 'sudo tail -n 100 /var/log/apache2/access.log | awk "{print \$1}" | sort | uniq -c | sort -nr'
   ```
2. **不正IPのブロック**
   ```bash
   sudo iptables -A INPUT -s 不正IP -j DROP
   ```
3. **CloudFlare導入検討**（将来的）

### SSL証明書期限切れ
1. **Let's Encrypt更新**
   ```bash
   sudo certbot renew --dry-run
   sudo certbot renew
   sudo systemctl restart apache2
   ```

## 🔧 定期更新作業手順

### 記事更新時のワークフロー
1. **ローカル編集**
   - HTMLファイル編集
   - 内容・リンク・価格情報更新
2. **品質チェック**
   - HTML構文チェック
   - リンク切れ確認
   - 誤字脱字チェック
3. **デプロイ実行**
   ```bash
   cd "C:/Users/chun7/OneDrive/デスクトップ/studyWorld/家電特化サイト"
   bash deploy.sh
   ```
4. **本番確認**
   - 更新されたページの表示確認
   - リンク動作確認

### 新記事追加時の手順
1. **ファイル作成**
   - `articles/new-article.html`作成
   - 既存記事をテンプレート活用
2. **URL統一確認**
   - 全URLが`www.otokuman.com`になっているか
   - 相対パス・絶対パスの整合性
3. **内部リンク追加**
   - 関連記事からのリンク追加
   - カテゴリページからのリンク追加
4. **sitemap.xml更新**
   - 新記事URLの追加
5. **デプロイ・確認**

### アフィリエイトリンク更新
1. **商品情報収集**
   - 新商品リリース情報
   - 価格変動・在庫状況
2. **リンク生成**
   - もしもアフィリエイトでリンク作成
   - 楽天・Yahoo両方の対応確認
3. **記事内反映**
   - `商品リンク/加湿器/`フォルダ内txtファイル更新
   - 記事HTML内のリンク差し替え
4. **効果測定準備**
   - アフィリエイト管理画面で効果測定設定

## 📊 パフォーマンス監視

### 定期測定項目
- **サイト速度** - Google PageSpeed Insights
- **SEO順位** - 主要キーワード順位追跡
- **アフィリエイト成果** - 月次収益・クリック率
- **ユーザー行動** - 滞在時間・回遊率

### 改善施策
**速度改善**:
- 画像最適化（WebP変換検討）
- CDN導入検討
- 不要なJavaScript削減

**SEO改善**:
- コンテンツ品質向上
- 内部リンク構造最適化
- 新しいキーワードでの記事作成

## 🔐 セキュリティ・バックアップ

### バックアップ戦略
1. **EC2スナップショット** - 月次、3ヶ月保持
2. **ファイルバックアップ** - 週次、ローカルコピー
   ```bash
   scp -r -i "C:/Users/chun7/Downloads/otokuman.pem" ubuntu@16.176.167.244:/var/www/html ./backup/$(date +%Y%m%d)/
   ```
3. **設定ファイルバックアップ** - Apache設定、.htaccess

### セキュリティ対策
- **定期パスワード変更**（管理画面実装後）
- **不要ポート閉鎖** - EC2セキュリティグループ設定
- **ログ監視** - 異常アクセスパターン検出
- **SSL/TLS設定** - 暗号化通信確保

## 📞 問題発生時の連絡フロー

### 緊急度レベル
- **レベル1** - サイト完全停止：即座対応
- **レベル2** - 一部機能停止：4時間以内対応  
- **レベル3** - 表示崩れ・軽微問題：24時間以内対応

### 対応記録
- **問題内容**：具体的症状・エラーメッセージ
- **発生時刻**：障害発生・発見時刻
- **対応内容**：実施した対策・コマンド
- **復旧時刻**：正常復旧確認時刻
- **再発防止策**：根本原因と予防策

---

**このチェックリストを印刷・ブックマークして定期的に実行すること**